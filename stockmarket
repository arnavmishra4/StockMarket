import requests
import pandas as pd 
import yfinance as yf 
from bs4 import BeautifulSoup
url = 'https://www.macrotrends.net/stocks/charts/TSLA/tesla/revenue'
data = requests.get(url).text
soup = BeautifulSoup(data,'html.parser')


revenue_df = pd.DataFrame(columns=["years", "revenue"])
tables = soup.find('table',class_ = 'historical_data_table table')


for row in soup.find_all('tr')[1:]: 
    col = row.find_all('td')
    year = col[0]
    revenue = col[1].text
    revenue_df= revenue_df.append({'Years' : year , 'Revenue': revenue})



revenue_df
